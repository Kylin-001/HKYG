# 黑科易购项目开发规范文档

## 1. 编码规范

### 1.1 Java编码规范

#### 命名规范
- **包名**：小写字母，使用反域名形式，如 `com.heikeji.admin.controller`
- **类名**：首字母大写的驼峰命名法，如 `UserController`
- **方法名**：首字母小写的驼峰命名法，如 `getUserInfo`
- **变量名**：首字母小写的驼峰命名法，如 `userId`
- **常量名**：全大写字母，下划线分隔，如 `MAX_PAGE_SIZE`
- **接口名**：以 `I` 开头或直接使用功能名称，如 `IUserService` 或 `UserService`
- **实现类**：功能名称+`Impl`，如 `UserServiceImpl`

#### 代码风格
- 缩进：使用4个空格，不使用Tab
- 行宽：每行不超过120个字符
- 方法长度：单个方法代码不超过100行
- 类长度：单个类不超过1000行
- 导入包：使用静态导入的方式导入常量和工具方法，避免使用通配符

#### 注释规范
- 类注释：使用Javadoc格式，包含类的功能描述、作者、创建日期
- 方法注释：使用Javadoc格式，包含方法功能、参数说明、返回值说明、异常说明
- 字段注释：对重要字段添加注释说明其用途
- 代码块注释：对复杂逻辑添加注释说明

```java
/**
 * 用户控制器
 * @author admin
 * @date 2024-01-01
 */
@RestController
@RequestMapping("/api/user")
public class UserController {
    
    /**
     * 获取用户信息
     * @param userId 用户ID
     * @return 用户信息
     * @throws NotFoundException 用户不存在时抛出
     */
    @GetMapping("/{userId}")
    public R<UserInfo> getUserInfo(@PathVariable Long userId) {
        // 方法实现...
    }
}
```

### 1.2 前端编码规范

#### 命名规范
- **组件名**：首字母大写的驼峰命名法，如 `UserList`
- **变量名**：使用小驼峰命名法，如 `userName`
- **常量名**：使用全大写字母，下划线分隔，如 `API_BASE_URL`
- **文件命名**：使用小驼峰或短横线分隔，如 `userList.vue` 或 `user-list.vue`

#### 代码风格
- 缩进：使用2个空格
- 单引号：使用单引号而非双引号
- 结尾逗号：对象和数组定义不使用结尾逗号
- 分号：每条语句后必须加分号

#### Vue组件规范
- 组件结构：template、script、style 按顺序排列
- Props定义：明确指定类型、默认值和验证规则
- 事件命名：使用小驼峰命名法，如 `@updateUser`
- 生命周期方法：按执行顺序排列

```vue
<template>
  <div class="user-list">
    <!-- 组件内容 -->
  </div>
</template>

<script>
export default {
  name: 'UserList',
  props: {
    userId: {
      type: Number,
      required: true
    }
  },
  data() {
    return {
      userList: []
    }
  }
}
</script>

<style scoped>
.user-list {
  /* 样式定义 */
}
</style>
```

## 2. 接口规范

### 2.1 RESTful API设计规范

#### HTTP方法使用
- **GET**：获取资源，如 `/api/users` 获取用户列表
- **POST**：创建资源，如 `/api/users` 创建新用户
- **PUT**：更新资源，如 `/api/users/1` 更新ID为1的用户
- **DELETE**：删除资源，如 `/api/users/1` 删除ID为1的用户
- **PATCH**：部分更新资源

#### URL设计
- 使用名词复数形式，如 `/users` 而非 `/user`
- 层次化表示资源关系，如 `/users/1/orders` 获取用户1的订单
- 避免使用动词，如 `/getUsers` 应改为 `/users`
- 使用短横线分隔多个单词，如 `/order-items`

#### 状态码使用
- **200 OK**：请求成功
- **201 Created**：资源创建成功
- **204 No Content**：请求成功但无返回内容
- **400 Bad Request**：请求参数错误
- **401 Unauthorized**：未授权
- **403 Forbidden**：禁止访问
- **404 Not Found**：资源不存在
- **500 Internal Server Error**：服务器内部错误

### 2.2 响应格式规范

#### 统一响应结构
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    // 具体数据内容
  }
}
```

#### 分页响应格式
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "list": [
      // 数据列表
    ],
    "total": 100,
    "page": 1,
    "limit": 10,
    "pages": 10
  }
}
```

#### 错误响应格式
```json
{
  "code": 400,
  "message": "参数错误",
  "data": null
}
```

### 2.3 参数规范

#### 查询参数
- 分页参数：`page`（页码）、`limit`（每页数量）
- 排序参数：`sort`（排序字段）、`order`（排序方向：asc/desc）
- 过滤参数：根据业务需求定义，如 `status`、`name` 等

#### 请求体格式
- 使用JSON格式传输数据
- 字段命名使用小驼峰命名法
- 时间格式：ISO 8601标准，如 `2024-01-01T12:00:00Z`

## 3. 数据库设计规范

### 3.1 命名规范
- **数据库名**：小写字母，下划线分隔，如 `heikeji_mall`
- **表名**：小写字母，下划线分隔，使用模块前缀，如 `user_info`、`order_item`
- **字段名**：小写字母，下划线分隔，如 `user_id`、`create_time`
- **索引名**：`idx_` + 表名 + `_` + 字段名，如 `idx_user_username`
- **外键名**：`fk_` + 表名 + `_` + 关联表名，如 `fk_order_user`

### 3.2 字段设计规范
- **主键**：使用自增ID（`BIGINT`类型）或UUID
- **时间字段**：使用 `DATETIME` 类型，默认值 `CURRENT_TIMESTAMP`
- **状态字段**：使用 `TINYINT` 类型，如 `status`：0-正常，1-禁用
- **枚举字段**：优先使用 `TINYINT` 或 `VARCHAR` 类型
- **金额字段**：使用 `DECIMAL(10,2)` 类型
- **字符串长度**：根据实际需求定义合理长度，避免过长

### 3.3 表设计规范
- 每张表必须包含 `id`、`create_time`、`update_time` 字段
- 重要表添加 `create_by`、`update_by` 字段记录操作人
- 适当添加注释说明表和字段用途
- 合理设计索引，避免全表扫描
- 遵循第三范式，减少数据冗余

```sql
CREATE TABLE `user_info` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT '用户ID',
  `username` VARCHAR(50) NOT NULL COMMENT '用户名',
  `password` VARCHAR(255) NOT NULL COMMENT '密码（加密存储）',
  `nickname` VARCHAR(50) DEFAULT NULL COMMENT '昵称',
  `avatar` VARCHAR(255) DEFAULT NULL COMMENT '头像',
  `status` TINYINT(1) DEFAULT 0 COMMENT '状态：0-正常，1-禁用',
  `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_username` (`username`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户信息表';
```

## 4. 安全规范

### 4.1 认证授权
- 使用JWT进行身份认证
- 基于RBAC模型进行权限控制
- 敏感操作需要二次验证
- 定期刷新Token

### 4.2 数据安全
- 密码加密存储（使用BCrypt等算法）
- 敏感数据传输使用HTTPS
- 防止SQL注入（使用参数化查询）
- 防止XSS攻击（输入验证和输出编码）
- 防止CSRF攻击（使用Token验证）

### 4.3 日志记录
- 记录用户登录日志
- 记录关键操作日志
- 记录系统错误日志
- 不记录敏感信息（密码、身份证号等）

## 5. 版本控制规范

### 5.1 Git分支规范
- **master/main**：主分支，用于生产环境
- **develop**：开发分支，日常开发
- **feature/xxx**：功能分支，新功能开发
- **bugfix/xxx**：bug修复分支
- **release/xxx**：发布分支，版本发布前准备

### 5.2 提交规范
- 提交信息清晰明了
- 每个提交只包含一个功能或修复
- 使用英文或中文提交信息
- 格式：`[模块] 简要描述`，如 `[用户模块] 修复登录失败问题`

## 6. 文档规范

### 6.1 技术文档
- 使用Markdown格式编写
- 文档结构清晰
- 及时更新，保持与代码同步
- 包含必要的图表说明

### 6.2 API文档
- 使用Swagger/OpenAPI生成API文档
- 完善接口描述、参数说明和返回值说明
- 提供接口调用示例

## 7. 开发流程规范

### 7.1 需求开发流程
1. 需求分析和评审
2. 技术方案设计
3. 任务拆分和分配
4. 代码开发
5. 单元测试
6. 代码审查
7. 集成测试
8. 上线部署
9. 功能验证
10. 项目总结

### 7.2 代码审查规范
- 检查代码是否符合编码规范
- 检查业务逻辑是否正确
- 检查是否存在安全漏洞
- 检查测试用例是否完备
- 提供建设性的改进建议

## 8. 测试规范

### 8.1 单元测试
- 测试覆盖率不低于80%
- 测试用例命名规范：`testMethodName_Scenario_ExpectedBehavior`
- 每个方法至少有一个正常场景和一个异常场景的测试

### 8.2 集成测试
- 验证模块间的交互
- 测试数据的一致性
- 测试事务的完整性

### 8.3 性能测试
- 接口响应时间：普通接口 < 500ms，复杂接口 < 1s
- 并发处理能力：根据业务需求设定合理的并发数
- 资源使用情况：监控CPU、内存、磁盘、网络使用

## 9. 注意事项

1. 严格遵守代码规范，保持代码风格一致性
2. 重视代码质量，避免引入不必要的依赖
3. 及时更新文档，保持文档与代码同步
4. 注意代码的可维护性和可扩展性
5. 安全第一，遵循安全规范
6. 注重团队协作，遵循开发流程规范

本规范文档将根据项目发展和团队反馈不断更新和完善。