# 黑科易购项目部署计划

## 1. 部署前准备

### 1.1 环境检查
- 确认Docker和Docker Compose已安装且版本符合要求
- 检查项目目录结构完整性
- 确认端口可用性

### 1.2 依赖准备
- 后端服务构建依赖：OpenJDK 17、Maven 3.8.0+
- 前端构建依赖：Node.js 18.x+

## 2. 部署步骤

### 2.1 构建后端服务
```bash
# 进入项目根目录
cd /home/heikeji/heikeji-mall

# 构建所有后端服务
mvn clean install '-Dmaven.test.skip=true'
```

### 2.2 构建前端服务
```bash
# 进入前端目录
cd heikeji-frontend

# 安装依赖
npm install

# 构建前端
npm run build
```

### 2.3 使用Docker Compose启动所有服务
```bash
# 回到项目根目录
cd /home/heikeji/heikeji-mall

# 启动所有服务
 docker-compose up -d

# 检查服务状态
 docker-compose ps
```

## 3. 验证部署

### 3.1 服务访问验证
- 前端：http://localhost
- Nacos控制台：http://localhost:8848/nacos
- RabbitMQ控制台：http://localhost:15672
- Zipkin控制台：http://localhost:9411/zipkin
- Swagger文档：http://localhost:8080/swagger-ui.html

### 3.2 服务日志检查
```bash
# 查看服务日志
 docker-compose logs -f [service-name]
```

## 4. 部署优化建议

### 4.1 生产环境优化
- 使用优化后的部署文件：参考DEPLOYMENT_OPTIMIZATION.md
- 配置HTTPS：为Nginx添加SSL证书
- 启用防火墙：配置ufw或firewalld
- 设置日志轮转：配置logrotate管理日志文件
- 监控告警：集成Prometheus和Grafana

### 4.2 性能优化
- 数据库优化：添加索引，优化查询
- Redis缓存：合理使用缓存，减少数据库压力
- 服务集群：对核心服务进行集群部署
- 负载均衡：使用Nginx或其他负载均衡器
- CDN加速：静态资源使用CDN加速

## 5. 常见问题排查

### 5.1 MySQL问题
- 无法启动MySQL：查看日志 `journalctl -xeu mysql`
- 身份认证失败：参考MYSQL_AUTHENTICATION_SOLUTION.md
- 密码忘记：参考MySQL密码重置文档

### 5.2 服务注册失败
- Nacos注册失败：检查Nacos服务是否启动，配置文件中的地址是否正确
- 服务间通信失败：检查网络配置，确保服务在同一网络中

### 5.3 前端问题
- 无法访问前端：检查Nginx配置和日志
- 前端无法调用API：检查Nginx反向代理配置，后端服务是否启动
- 静态资源加载失败：检查静态资源路径配置

### 5.4 端口冲突
```bash
# 查看端口占用情况
 netstat -tuln | grep [port]

# 查找占用端口的进程
 lsof -i :[port]

# 终止占用端口的进程
 kill -9 [pid]
```