<!-- 订单确认页面 -->
<view class="container">
  <!-- 页面头部 -->
  <view class="header">
    <view class="header-left" bindtap="onBack">
      <image src="/assets/icons/back.png" class="back-icon" mode="aspectFit"></image>
    </view>
    <text class="header-title">确认订单</text>
    <view class="header-right"></view>
  </view>

  <!-- 收货地址 -->
  <view class="address-section" bindtap="chooseAddress">
    <view class="address-header">
      <text class="address-title">收货地址</text>
      <image src="/assets/icons/arrow-right.png" class="arrow-icon" mode="aspectFit"></image>
    </view>
    <view class="address-content" wx:if="{{selectedAddress}}">
      <view class="address-name-phone">
        <text class="address-name">{{selectedAddress.name}}</text>
        <text class="address-phone">{{selectedAddress.phone}}</text>
      </view>
      <text class="address-detail">{{selectedAddress.province}}{{selectedAddress.city}}{{selectedAddress.district}}{{selectedAddress.detailAddress}}</text>
    </view>
    <view class="address-empty" wx:else>
      <text class="empty-text">请选择收货地址</text>
    </view>
  </view>

  <!-- 商品信息 -->
  <view class="goods-section">
    <view class="section-title">商品信息</view>
    <block wx:for="{{orderGoods}}" wx:key="id">
      <view class="goods-item">
        <image src="{{item.image}}" class="goods-image" mode="aspectFill"></image>
        <view class="goods-info">
          <text class="goods-name">{{item.name}}</text>
          <text class="goods-spec" wx:if="{{item.spec}}">{{item.spec}}</text>
          <view class="goods-price-quantity">
            <text class="goods-price">¥{{item.price}}</text>
            <text class="goods-quantity">x{{item.quantity}}</text>
          </view>
        </view>
      </view>
    </block>
  </view>

  <!-- 配送方式 -->
  <view class="delivery-section">
    <view class="section-title">配送方式</view>
    <view class="delivery-options">
      <view 
        class="delivery-option {{selectedDelivery === 'normal' ? 'selected' : ''}}"
        data-delivery="normal"
        bindtap="selectDelivery"
      >
        <view class="delivery-info">
          <text class="delivery-name">普通配送</text>
          <text class="delivery-desc">预计30-60分钟送达</text>
        </view>
        <view class="delivery-fee">
          <text class="fee-text">¥{{deliveryFee.normal}}</text>
          <image 
            src="{{selectedDelivery === 'normal' ? '/assets/icons/radio-selected.png' : '/assets/icons/radio.png'}}" 
            class="radio-icon" 
            mode="aspectFit"
          ></image>
        </view>
      </view>
      <view 
        class="delivery-option {{selectedDelivery === 'fast' ? 'selected' : ''}}"
        data-delivery="fast"
        bindtap="selectDelivery"
      >
        <view class="delivery-info">
          <text class="delivery-name">快速配送</text>
          <text class="delivery-desc">预计15-30分钟送达</text>
        </view>
        <view class="delivery-fee">
          <text class="fee-text">¥{{deliveryFee.fast}}</text>
          <image 
            src="{{selectedDelivery === 'fast' ? '/assets/icons/radio-selected.png' : '/assets/icons/radio.png'}}" 
            class="radio-icon" 
            mode="aspectFit"
          ></image>
        </view>
      </view>
    </view>
  </view>

  <!-- 支付方式 -->
  <view class="payment-section">
    <view class="section-title">支付方式</view>
    <view class="payment-options">
      <block wx:for="{{paymentMethods}}" wx:key="id">
        <view 
          class="payment-option {{selectedPayment === item.id ? 'selected' : ''}}"
          data-payment-id="{{item.id}}"
          bindtap="selectPayment"
        >
          <view class="payment-info">
            <image src="{{item.icon}}" class="payment-icon" mode="aspectFit"></image>
            <text class="payment-name">{{item.name}}</text>
          </view>
          <image 
            src="{{selectedPayment === item.id ? '/assets/icons/radio-selected.png' : '/assets/icons/radio.png'}}" 
            class="radio-icon" 
            mode="aspectFit"
          ></image>
        </view>
      </block>
    </view>
  </view>

  <!-- 订单备注 -->
  <view class="remark-section">
    <view class="section-title">订单备注</view>
    <input 
      class="remark-input" 
      placeholder="请输入订单备注（选填）" 
      placeholder-class="placeholder" 
      value="{{remark}}" 
      bindinput="onRemarkInput"
    ></input>
  </view>

  <!-- 优惠券选择 -->
  <view class="coupon-section" bindtap="selectCoupon">
    <view class="section-title">优惠券</view>
    <view class="coupon-content">
      <view class="coupon-info">
        <text class="coupon-label">优惠券</text>
        <text class="coupon-value" wx:if="{{selectedCoupon}}">-¥{{selectedCoupon.amount}}</text>
        <text class="coupon-value" wx:else>未选择优惠券</text>
      </view>
      <image src="/assets/icons/arrow-right.png" class="arrow-icon" mode="aspectFit"></image>
    </view>
  </view>

  <!-- 价格明细 -->
  <view class="price-section">
    <view class="price-item">
      <text class="price-label">商品总价</text>
      <text class="price-value">¥{{goodsTotal}}</text>
    </view>
    <view class="price-item">
      <text class="price-label">配送费</text>
      <text class="price-value">¥{{deliveryFee[selectedDelivery]}}</text>
    </view>
    <view class="price-item">
      <text class="price-label">优惠券</text>
      <text class="price-value discount">-¥{{couponDiscount}}</text>
    </view>
    <view class="price-item total">
      <text class="price-label">实付金额</text>
      <text class="price-value total">{{actualTotal}}</text>
    </view>
  </view>

  <!-- 底部结算栏 -->
  <view class="bottom-bar">
    <view class="total-price">
      <text class="total-label">实付：</text>
      <text class="total-amount">¥{{actualTotal}}</text>
    </view>
    <button class="submit-btn" bindtap="submitOrder" loading="{{submitLoading}}">{{submitLoading ? '提交中...' : '提交订单'}}</button>
  </view>
</view>
